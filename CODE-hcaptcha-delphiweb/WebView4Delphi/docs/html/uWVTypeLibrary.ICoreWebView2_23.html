<!DOCTYPE html>
<html lang="en">
<head>
<title>WebView4Delphi: uWVTypeLibrary: Interface ICoreWebView2_23</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="generator" content="PasDoc 0.16.0-snapshot">
<meta http-equiv="content-type" content="text/html; charset=utf-8">
<link rel="StyleSheet" type="text/css" href="pasdoc.css">
</head>
<body>
<span id="ICoreWebView2_23"></span><h1 class="cio">Interface ICoreWebView2_23</h1>
<div class="sections">
<div class="one_section"><a class="section" href="#PasDoc-Description">Description</a></div><div class="one_section"><a class="section" href="#PasDoc-Hierarchy">Hierarchy</a></div><div class="one_section">Fields</div><div class="one_section"><a class="section" href="#PasDoc-Methods">Methods</a></div><div class="one_section">Properties</div></div>
<span id="PasDoc-Description"></span><h2 class="unit">Unit</h2>
<p class="unitlink">
<a href="uWVTypeLibrary.html">uWVTypeLibrary</a></p>
<h2 class="declaration">Declaration</h2>
<p class="declaration">
<code>type ICoreWebView2_23 = interface(<a class="normal" href="uWVTypeLibrary.ICoreWebView2_22.html">ICoreWebView2_22</a>)</code></p>
<h2 class="description">Description</h2>
<p>
 This is the ICoreWebView_23 interface for PostWebMessageAsJsonWithAdditionalObjects. </p>
<p>


<p>&lt;see href=&quot;<a href="https://learn.microsoft.com/en-us/microsoft-edge/webview2/reference/win32/icorewebview2_23">https://learn.microsoft.com/en-us/microsoft-edge/webview2/reference/win32/icorewebview2_23</a>&quot;&gt;See the ICoreWebView2_23 article.)</p>
<span id="PasDoc-Hierarchy"></span><h2 class="hierarchy">Hierarchy</h2>
<ul class="hierarchy"><li class="ancestor">IUnknown</li>
<li class="ancestor"><a class="normal" href="uWVTypeLibrary.ICoreWebView2.html">ICoreWebView2</a></li>
<li class="ancestor"><a class="normal" href="uWVTypeLibrary.ICoreWebView2_2.html">ICoreWebView2_2</a></li>
<li class="ancestor"><a class="normal" href="uWVTypeLibrary.ICoreWebView2_3.html">ICoreWebView2_3</a></li>
<li class="ancestor"><a class="normal" href="uWVTypeLibrary.ICoreWebView2_4.html">ICoreWebView2_4</a></li>
<li class="ancestor"><a class="normal" href="uWVTypeLibrary.ICoreWebView2_5.html">ICoreWebView2_5</a></li>
<li class="ancestor"><a class="normal" href="uWVTypeLibrary.ICoreWebView2_6.html">ICoreWebView2_6</a></li>
<li class="ancestor"><a class="normal" href="uWVTypeLibrary.ICoreWebView2_7.html">ICoreWebView2_7</a></li>
<li class="ancestor"><a class="normal" href="uWVTypeLibrary.ICoreWebView2_8.html">ICoreWebView2_8</a></li>
<li class="ancestor"><a class="normal" href="uWVTypeLibrary.ICoreWebView2_9.html">ICoreWebView2_9</a></li>
<li class="ancestor"><a class="normal" href="uWVTypeLibrary.ICoreWebView2_10.html">ICoreWebView2_10</a></li>
<li class="ancestor"><a class="normal" href="uWVTypeLibrary.ICoreWebView2_11.html">ICoreWebView2_11</a></li>
<li class="ancestor"><a class="normal" href="uWVTypeLibrary.ICoreWebView2_12.html">ICoreWebView2_12</a></li>
<li class="ancestor"><a class="normal" href="uWVTypeLibrary.ICoreWebView2_13.html">ICoreWebView2_13</a></li>
<li class="ancestor"><a class="normal" href="uWVTypeLibrary.ICoreWebView2_14.html">ICoreWebView2_14</a></li>
<li class="ancestor"><a class="normal" href="uWVTypeLibrary.ICoreWebView2_15.html">ICoreWebView2_15</a></li>
<li class="ancestor"><a class="normal" href="uWVTypeLibrary.ICoreWebView2_16.html">ICoreWebView2_16</a></li>
<li class="ancestor"><a class="normal" href="uWVTypeLibrary.ICoreWebView2_17.html">ICoreWebView2_17</a></li>
<li class="ancestor"><a class="normal" href="uWVTypeLibrary.ICoreWebView2_18.html">ICoreWebView2_18</a></li>
<li class="ancestor"><a class="normal" href="uWVTypeLibrary.ICoreWebView2_19.html">ICoreWebView2_19</a></li>
<li class="ancestor"><a class="normal" href="uWVTypeLibrary.ICoreWebView2_20.html">ICoreWebView2_20</a></li>
<li class="ancestor"><a class="normal" href="uWVTypeLibrary.ICoreWebView2_21.html">ICoreWebView2_21</a></li>
<li class="ancestor"><a class="normal" href="uWVTypeLibrary.ICoreWebView2_22.html">ICoreWebView2_22</a></li>
<li class="thisitem">ICoreWebView2_23</li></ul><h2 class="overview">Overview</h2>
<span id="PasDoc-Methods"></span><h3 class="summary">Methods</h3>
<table class="summary wide_list">
<tr class="list">
<td class="visibility"><a href="legend.html"><img  src="public.gif" alt="Public" title="Public"></a></td>
<td class="itemcode"><code>function <strong><a href="uWVTypeLibrary.ICoreWebView2_23.html#PostWebMessageAsJsonWithAdditionalObjects-PWideChar-ICoreWebView2ObjectCollectionView-">PostWebMessageAsJsonWithAdditionalObjects</a></strong>(webMessageAsJson: PWideChar; const additionalObjects: <a href="uWVTypeLibrary.ICoreWebView2ObjectCollectionView.html">ICoreWebView2ObjectCollectionView</a>): HResult; stdcall;</code></td>
</tr>
</table>
<h2 class="description">Description</h2>
<h3 class="detail">Methods</h3>
<table class="detail wide_list">
<tr class="list">
<td class="visibility"><a href="legend.html"><img  src="public.gif" alt="Public" title="Public"></a></td>
<td class="itemcode"><span id="PostWebMessageAsJsonWithAdditionalObjects-PWideChar-ICoreWebView2ObjectCollectionView-"></span><code>function <strong>PostWebMessageAsJsonWithAdditionalObjects</strong>(webMessageAsJson: PWideChar; const additionalObjects: <a href="uWVTypeLibrary.ICoreWebView2ObjectCollectionView.html">ICoreWebView2ObjectCollectionView</a>): HResult; stdcall;</code></td>
</tr>
<tr><td colspan="2">
<p>
 Same as `PostWebMessageAsJson`, but also has support for posting DOM objects to page content. The `additionalObjects` property in the DOM MessageEvent fired on the page content is an array-like list of DOM objects that can be posted to the web content. Currently these can be the following types of objects:

<p>| Win32 | DOM type | |&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;-|&mdash;&mdash;&mdash;&mdash;-| | ICoreWebView2FileSystemHandle | [FileSystemHandle](<a href="https://developer.mozilla.org/docs/Web/API/FileSystemHandle">https://developer.mozilla.org/docs/Web/API/FileSystemHandle</a>) | | nullptr | null |

<p>The objects are posted to the web content, following the [structured-clone](<a href="https://developer.mozilla.org/docs/Web/API/Web_Workers_API/Structured_clone_algorithm">https://developer.mozilla.org/docs/Web/API/Web_Workers_API/Structured_clone_algorithm</a>) semantics, meaning only objects that can be cloned can be posted. They will also behave as if they had been created by the web content they are posted to. For example, if a FileSystemFileHandle is posted to a web content it can only be re-transferred via postMessage to other web content [with the same origin](<a href="https://fs.spec.whatwg.org/#filesystemhandle">https://fs.spec.whatwg.org/#filesystemhandle</a>). Warning: An app needs to be mindful when using this API to post DOM objects as this API provides the web content with unusual access to sensitive Web Platform features such as filesystem access! Similar to PostWebMessageAsJson the app should check the `Source` property of WebView2 right before posting the message to ensure the message and objects will only be sent to the target web content that it expects to receive the DOM objects. Additionally, the order of messages that are posted between `PostWebMessageAsJson` and `PostWebMessageAsJsonWithAdditionalObjects` may not be preserved. \snippet ScenarioFileSystemHandleShare.cpp PostWebMessageWithAdditionalObjects </p>
<h6 class="description_section">Attributes</h6>
<dl class="attributes">
  <dt>GUID['{508F0DB5-90C4-5872-90A7-267A91377502}']</dt>
  <dd></dd>
</dl>
</td></tr>
</table>
<hr><span class="appinfo"><em>Generated by <a href="https://pasdoc.github.io/">PasDoc 0.16.0-snapshot</a>. </em>
</span>
</body></html>
